protocol demo_protocol {
	message start_sess {
		u8[2] HDR = [DEh ADh]
		u8[32] ID
		check-sum u16 CSUM
	}
	
	message ping {
		u8[2] HDR = [DEh EDh]
		check-sum u8 CSUM
	}
	
	message pong {
		u8[2] HDR = [FEh EDh]
		check-sum u8 CSUM
	}
	
	message keyb_event {
		u8[2] HDR = [CAh FEh]
		
		u8 enum EVENT { // Command
			KEY_DOWN 01h
			KEY_UP   FFh
		}
		
		bit-mask MODIF { 0:SHIFT, 1:ALT, 2:CTRL, 3-7:RSV }
		u8 KEY
		u16 X
		check-sum u16 CSUM
	}
	
	message terminate_sess {
		u8[2] HDR = [BEh EFh]
		check-sum u32 CSUM1
		check-sum u32 CSUM2
	}
}
